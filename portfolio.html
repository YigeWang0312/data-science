<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <link href="styles.css" rel="stylesheet" />
    <link href="portfolio.css" rel="stylesheet" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/dark.min.css">
</head>
<body id="portfolio">
<nav>
    <div class="site-title">
        <h3>Data Science</h3>
        <p>by Yige Wang | 1870312</p>
    </div>
    <div class="nav-menu">
        <a href="./">Home</a>
        <a href="./project.html">Project</a>
        <a href="./portfolio.html">Portfolio</a>
        <a href="https://github.com/YigeWang0312/data-science">Explore Github</a>
    </div>
</nav>
<main>
<h1>Portfolio</h1>
<ol class="portfolio">
    <li id="week1">
        <h2>Week1: Building a site</h2>
        <p>Build your multi-page site. Host it on GitHub, with at least two pages: index (your
            portfolio) and project. Feel free to add more pages (about etc) and make your index and into page. If
            you do this make a clear portfolio page – this is what we will mark.</p>
        <div>
            <p>This <a href="./">Website</a> is hosted via Github pages</p>
        </div>
    </li>
    <li id="week2">
        <h2>Week2: Embedding</h2>
        <p>Embed three charts, two that are given to you in class. One (as homework) taken from the
            repository of charts that drive www.rapidcharts.io</p>
        <div>
            <div class="vega-container">
                <div class="vega-caption">Bitcoin long run (<a href="https://github.com/RDeconomist/RDeconomist.github.io/blob/main/charts/crypto/chartcrypto1.json">Source</a>)</div>
                <div class="vega-canvas"></div>
                <script type="text/data">
                    {
                      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",


                     "title": {
                      "text": "Bitcoin long term prices",
                      "subtitle":"Daily BTC price in USD. Source: Coinbase via FRED",
                      "subtitleFontStyle":"italic",
                      "subtitleFontSize":10,
                      "anchor": "start",
                      "color": "#179fdb",
                      "subtitleColor":"#179fdb"},

                    "config": {
                      "background":"#122b39",
                      "view": {
                        "stroke": "transparent"}},



                      "width":290,
                      "height":300,


                      "data": {
                        "name":"myData",
                        "url": "https://raw.githubusercontent.com/RDeconomist/RDeconomist.github.io/main/charts/crypto/dataFREDbtcCoinbase.csv"},


                      "mark": {
                      "type": "line",
                      "point": false,
                      "interpolate": "linear",
                      "color":"#f4c245"
                    },


                      "transform": [
                        {"calculate": "timeParse(datum.DATE, '%d/%m/%Y')", "as": "date"},
                        {"calculate": "year(datum.date)", "as": "year"},

                        {"filter": "datum.year>=minYear"},
                        {"filter": "datum.year<=maxYear"}
                    ],

                      "params": [
                        {"name":"minYear", "value":2016,
                           "bind":{
                             "input": "range",
                             "min": 2016,
                             "max": 2021,
                             "step": 1,
                             "name": "Start year:"}
                        },

                        {"name":"maxYear", "value":2021,
                           "bind":{
                             "input": "range",
                             "min": 2016,
                             "max": 2021,
                             "step": 1,
                             "name": "End year:"}
                        }
                      ],



                      "encoding": {


                      "x": {
                        "field": "date",
                        "type": "temporal",
                        "axis": {
                          "title": null,
                          "grid": false,
                          "labelSeparation": 10,
                          "domainColor":"dimgrey",
                          "labelColor":"#00a767",
                          "tickColor":"pink",
                          "gridColor":"dimgrey"
                        }},

                      "y": {
                        "field": "CBBTCUSD",
                        "type": "quantitative",
                        "title": "",
                        "axis": {
                          "grid": false,
                          "domainColor":"dimgrey",
                          "labelColor":"#00a767",
                          "tickColor":"pink",
                          "gridColor":"dimgrey",
                          "format":"$,.5"}
                          }
                       }
                    }
                </script>
            </div>
        </div>
    </li>
    <li id="week3-1">
        <h2>Week3: Hosting data</h2>
        <div>
            <div class="vega-container">
                <div class="vega-caption">IMF Outstanding Credit</div>
                <div class="vega-canvas"></div>
                <script type="text/data">
                {
                   "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
                   "background": "#333333",
                   "title":{
                      "text":"IMF Outstanding Credit",
                      "subtitle":"in SDRs from 1984 - 2022 in billions Source: IMF",
                      "subtitleFontSize":8,
                      "subtitleColor":"#ffffff",
                      "anchor":"start",
                      "color":"#ffffff"
                   },
                   "data":{
                      "url":"data/extcred1.csv"
                   },
                   "transform":[
                      {
                         "calculate":"datum.total/1000000000",
                         "as":"billions"
                      }
                   ],
                   "mark":{
                      "type":"bar",
                      "color": "#616AA5"
                   },
                   "encoding":{
                      "x":{
                         "field":"year",
                         "type":"temporal",
                         "axis":{
                            "title":"Year",
                            "grid":false,
                            "ticks":false,
                            "labelAngle":30,
                            "labelColor":"#ffffff",
                            "titleColor":"#ffffff"
                         }
                      },
                      "y":{
                         "field":"billions",
                         "type":"quantitative",
                         "title":"Outstanding Credit(billion $)",
                         "axis":{
                            "grid":false,
                            "labelColor":"#ffffff",
                            "titleColor":"#ffffff"
                         }
                      }
                   }
                }
                </script>
            </div>
        </div>
    </li>
    <li id="week3-2">
        <h2>Week3: Hosting data</h2>
        <div class="vega-container">
            <div class="vega-caption">IMF Outstanding Credit vs World GDP</div>
            <div class="vega-canvas"></div>
            <script type="text/data">
                {
                   "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
                   "background": "#333333",
                   "title":{
                      "text":"IMF Outstanding Credit vs World GDP",
                      "subtitle":"1984-2021. Source: IMF & World Bank",
                      "subtitleFontSize":8,
                      "subtitleColor":"#ffffff",
                      "anchor":"start",
                      "color":"#ffffff"
                   },
                   "data":{
                      "url":"data/creditgdp.csv"
                   },
                   "mark":{
                      "type":"bar",
                      "color": "#616AA5"
                   },
                   "encoding":{
                      "x":{
                         "field":"year",
                         "type":"temporal",
                         "axis":{
                            "title":"Year",
                            "grid":false,
                            "ticks":false,
                            "labelAngle":30,
                            "labelColor":"#ffffff",
                            "titleColor":"#ffffff"
                         }
                      },
                      "y":{
                         "field":"percentage",
                         "type":"quantitative",
                         "title":"Outstanding Credit vs % world GDP",
                         "axis":{
                            "grid":false,
                            "labelColor":"#ffffff",
                            "titleColor":"#ffffff"
                         }
                      }
                   }
                }
                </script>
        </div>
    </li>
    <li class="figure">
        <h2>Week4</h2>
        <p>Created this pie chart using Colab, from OWID covid data</p>
        <div class="undersized-image">
            <figure>
                <img src="images/pie-chart-from-colab.png" alt="pire chart"/>
                <figcaption># of hospitalizations per country</figcaption>
                <a href="https://colab.research.google.com/drive/1YvwpI5Exj16IWXT2e4pKIyUGiSw3IuyV?usp=sharing" class="source">
                    (See in Colab)
                </a>
            </figure>

        </div>
    </li>
    <li id="week5">
        <h2>Week5: 9 Graphs from ONS</h2>
        <div class="vega-containers">
            <div class="vega-container">
                <div class="vega-canvas"></div>
                <script type="text/data">
                    {
                       "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
                       "background": "#333333",
                       "title":{
                          "text":"CG: Covid Corp Finance Facility: Commercial Paper: £m: NSA",
                          "subtitleFontSize":8,
                          "subtitleColor":"#ffffff",
                          "anchor":"start",
                          "color":"#ffffff"
                       },
                       "data":{
                          "url":"data/week5/fsx6_pusf.json",
                          "format": {"type": "json", "property": "years"}
                       },
                       "mark":{
                          "type":"bar",
                          "color": "#616AA5",
                          "width": {"band":0.4}
                       },
                       "transform": [
                            {
                              "filter": "datum.value > 0"
                            }
                        ],
                        "encoding": {
                          "x": {
                            "field": "label",
                            "type": "ordinal",
                             "axis":{
                                "title":"Year",
                                "grid":false,
                                "ticks":2,
                                "labelAngle":30,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             }
                          },
                          "y": {
                            "field": "value",
                            "type": "quantitative",
                             "axis":{
                                "title": "£m",
                                "grid":false,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             }
                          },
                          "tooltip": [
                            {"field":"label"},
                            {"field":"value"}
                          ]
                        }
                    }
                    </script>
            </div>
            <div class="vega-container">
                <div class="vega-canvas"></div>
                <script type="text/data">
                    {
                       "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
                       "background": "#333333",
                       "title":{
                          "text":"CG: Covid Corp Finance Facility: Net cash requirement: £m: NSA",
                          "subtitleColor":"#ffffff",
                          "anchor":"start",
                          "color":"#ffffff"
                       },
                       "data":{
                          "url":"data/week5/fsx7_pusf.json",
                          "format": {"type": "json", "property": "months"}
                       },
                       "mark":{
                          "type":"bar",
                          "color": "#616AA5",
                          "width": {"band":0.4}                   },
                       "transform": [
                            {
                              "filter": "datum.value > 0"
                            }
                        ],
                        "encoding": {
                          "x": {
                            "field": "label",
                            "type": "ordinal",
                             "axis":{
                                "title":"Month",
                                "grid":false,
                                "ticks":2,
                                "labelAngle":30,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             }
                          },
                          "y": {
                            "field": "value",
                            "type": "quantitative",
                             "axis":{
                                "title": "£m",
                                "grid":false,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             },
                             "scale": {
                                "domain": [0, 17000]
                             }
                          },
                          "tooltip": [
                            {"field":"label"},
                            {"field":"value"}
                          ]
                        }
                    }
                    </script>
            </div>
            <div class="vega-container">
                <div class="vega-canvas"></div>
                <script type="text/data">
                    {
                       "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
                       "background": "#333333",
                       "title":{
                          "text":"Trade in Goods (T): WW: Exports: BOP: CP: SA",
                          "subtitleColor":"#ffffff",
                          "anchor":"start",
                          "color":"#ffffff"
                       },
                       "data":{
                          "url":"data/week5/bokg_pnbp.json",
                          "format": {"type": "json", "property": "years"}
                       },
                       "mark":{
                          "type":"line",
                          "point": true,
                          "color": "#616AA5",
                          "width": {"band":0.4}
                       },
                       "transform": [
                            {
                              "filter": "datum.value > 0 && datum.year >= 2015 "
                            }
                        ],
                        "encoding": {
                          "x": {
                            "field": "label",
                            "type": "ordinal",
                             "axis":{
                                "title":"Year",
                                "grid":false,
                                "ticks":2,
                                "labelAngle":30,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             }
                          },
                          "y": {
                            "field": "value",
                            "type": "quantitative",
                             "axis":{
                                "title": "£m",
                                "grid":false,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             },
                             "scale": {
                                "domain": [250000,400000]
                             }
                          },
                          "tooltip": [
                            {"field":"label"},
                            {"field":"value"}
                          ]
                        }
                    }
                    </script>
            </div>
            <div class="vega-container">
                <div class="vega-canvas"></div>
                <script type="text/data">
                    {
                       "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
                       "background": "#333333",
                       "title":{
                          "text":"Trade in Goods (T): WW: Imports: BOP: CP: SA",
                          "subtitleColor":"#ffffff",
                          "anchor":"start",
                          "color":"#ffffff"
                       },
                       "data":{
                          "url":"data/week5/bokh_pnbp.json",
                          "format": {"type": "json", "property": "years"}
                       },
                       "mark":{
                          "type":"line",
                          "point": true,
                          "color": "#616AA5",
                          "width": {"band":0.4}
                       },
                       "transform": [
                            {
                              "filter": "datum.value > 0 && datum.year >= 2015 "
                            }
                        ],
                        "encoding": {
                          "x": {
                            "field": "label",
                            "type": "ordinal",
                             "axis":{
                                "title":"Year",
                                "grid":false,
                                "ticks":2,
                                "labelAngle":30,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             }
                          },
                          "y": {
                            "field": "value",
                            "type": "quantitative",
                             "axis":{
                                "title": "£m",
                                "grid":false,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             },
                             "scale": {
                                "domainMin": 400000,
                                "domainMax": 520000
                             }
                          },
                          "tooltip": [
                            {"field":"label"},
                            {"field":"value"}
                          ]
                        }
                    }
                    </script>
            </div>
            <div class="vega-container">
                <div class="vega-canvas"></div>
                <script type="text/data">
                    {
                       "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
                       "background": "#333333",
                       "data": {
                          "name": "source",
                          "url":"data/week5/ikbb_pnbp.json",
                          "format": {"type": "json", "property": "years"}
                       },
                       "title":{
                          "text": "Trade in Services (TS): WW: Exports: BOP: CP: SA",
                          "subtitleColor":"#ffffff",
                          "anchor":"start",
                          "color":"#ffffff"
                       },
                       "mark":{
                          "type":"line",
                          "point": true,
                          "color": "#616AA5",
                          "width": {"band":0.4}
                       },
                       "transform": [
                            {
                              "filter": "datum.value > 0 && datum.year >= 2015 "
                            }
                        ],
                        "encoding": {
                          "x": {
                            "source":"data",
                            "field": "label",
                            "type": "ordinal",
                             "axis":{
                                "title":"Year",
                                "grid":false,
                                "ticks":2,
                                "labelAngle":30,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             }
                          },
                          "y": {
                            "source":"data",
                            "field": "value",
                            "type": "quantitative",
                             "axis":{
                                "title": "£m",
                                "grid":false,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             },
                             "scale": {
                                "domain": {"data": "source", "field": "value"}
                             }
                          },
                          "tooltip": [
                            {"field":"label"},
                            {"field":"value"}
                          ]
                        }
                    }
                    </script>
            </div>
            <div class="vega-container">
                <div class="vega-canvas"></div>
                <script type="text/data">
                    {
                       "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
                       "background": "#333333",
                       "data": {
                          "name": "source",
                          "url":"data/week5/ikbc_pnbp.json",
                          "format": {"type": "json", "property": "years"}
                       },
                       "title":{
                          "text": "Trade in Services (TS): WW: Imports: BOP: CP: SA",
                          "subtitleColor":"#ffffff",
                          "anchor":"start",
                          "color":"#ffffff"
                       },
                       "mark":{
                          "type":"line",
                          "point": true,
                          "color": "#616AA5",
                          "width": {"band":0.4}
                       },
                       "transform": [
                            {
                              "filter": "datum.value > 0 && datum.year >= 2015 "
                            }
                        ],
                        "encoding": {
                          "x": {
                            "source":"data",
                            "field": "label",
                            "type": "ordinal",
                             "axis":{
                                "title":"Year",
                                "grid":false,
                                "ticks":2,
                                "labelAngle":30,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             }
                          },
                          "y": {
                            "source":"data",
                            "field": "value",
                            "type": "quantitative",
                             "axis":{
                                "title": "£m",
                                "grid":false,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             },
                             "scale": {
                                "domain": {"data": "source", "field": "value"}
                             }
                          },
                          "tooltip": [
                            {"field":"label"},
                            {"field":"value"}
                          ]
                        }
                    }
                    </script>
            </div>
            <div class="vega-container">
                <div class="vega-canvas"></div>
                <script type="text/data">
                    {
                       "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
                       "background": "#333333",
                       "data": {
                          "name": "source",
                          "url":"data/week5/l2kq_pn2.json",
                          "format": {"type": "json", "property": "quarters"}
                       },
                       "title":{
                          "text": "Total Production : Sections B, C, D and E (Index):CVM",
                          "subtitleColor":"#ffffff",
                          "anchor":"start",
                          "color":"#ffffff"
                       },
                       "mark":{
                          "type":"line",
                          "point": true,
                          "color": "#616AA5",
                          "width": {"band":0.4}
                       },
                       "transform": [
                            {
                              "filter": "datum.value > 0 && datum.year >= 2018 "
                            }
                        ],
                        "encoding": {
                          "x": {
                            "field": "label",
                            "type": "ordinal",
                             "axis":{
                                "title":"Year",
                                "grid":false,
                                "ticks":false,
                                "labelAngle":90,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             }
                          },
                          "y": {
                            "field": "value",
                            "type": "quantitative",
                             "axis":{
                                "title":"Index, base year = 100",
                                "grid":false,
                                "labelColor":"#ffffff",
                                "titleColor":"#ffffff"
                             },
                             "scale": {
                                "domain": [80, 120]
                             }
                          },
                          "tooltip": [
                            {"field":"label"},
                            {"field":"value"}
                          ]
                        }
                    }
                    </script>
            </div>
        </div>
    </li>
    <li>
        <h2>Week8: Merging data</h2>
        <p>Build a chart with data from two separate sources. Plot these data using correlation,
            regression or some other technique.</p>
        <div>
            <div class="table">
                <table>
                    <caption>Travel Ideas</caption>
                    <thead>
                        <tr>
                            <th>Location</th>
                            <th>ETA/Duration</th>
                            <th>Weather</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Blenhelm Palace</td><td>...</td><td>...</td>
                        </tr>
                        <tr>
                            <td>Canterbury Cathedral</td><td>...</td><td>...</td>
                        </tr>
                        <tr>
                            <td>Windsor Castle</td><td>...</td><td>...</td>
                        </tr>
                        <tr>
                            <td>Stonehedge</td><td>...</td><td>...</td>
                        </tr>
                        <tr>
                            <td>Peak District National Park</td>
                            <td>...</td><td>...</td>
                        </tr>
                    </tbody>
                </table>
                <p>This table combines data from weatherapi.com and google.com's direction API</p>
                <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBZkcc6D3OmYOsunlNNSyeOx3KGYPLGids"></script>
                <script type="text/javascript" defer class="expose">
                    const table = document.currentScript.closest('div').querySelector('table');
                    const rows = table.querySelectorAll('tbody tr');
                    const locations = [...rows].map( (row) => row.querySelector('td').innerText );

                    for (let x = 0; x<locations.length; x++) {
                        const location = locations[x] + ', UK';
                        const row = rows[x];
                        const cells = row.querySelectorAll('td');
                        const etaCell = cells[1];
                        const weatherCell = cells[2];
                        (async () =>  etaCell.innerText = await getDrivingEta(location))();
                        (async () =>  weatherCell.innerHTML = await getWeather(location))();
                    }

                    async function getWeather(location) {
                        const apiKey = '568507c821cc4c5997352427220107';
                        const apiUrl = 'https://api.weatherapi.com/v1/current.json?key='
                        + apiKey
                        + '&q=' + location + '&aqi=no';

                        json = await  fetch(apiUrl)
                            .then((r) => r.json());
                        return '<img src="'+ json.current.condition.icon + '" class="weather-icon" /> '
                            +json.current.condition.text;
                    }

                    async function getDrivingEta(location) {
                        const service = new google.maps.DistanceMatrixService();
                        json = await service.getDistanceMatrix(
                            {
                                origins: ['London'],
                                destinations: [ location ],
                                travelMode: 'DRIVING'
                            },
                            (json) => {
                                //console.log(json);
                            }
                        );
                        return json.rows[0]?.elements[0]?.duration.text;
                    }
                </script>
        </div>
    </li>
    <li>
        <h2>Week9: Advanced analytics</h2>
        <p>Build and embed a chart that uses advanced statistical methods, testing causality
            or distribution</p>
        <div>
            <p>This website is hosted via github pages: https://yigewang0312.github.io/data-science/portfolio.html</p>
        </div>
    </li>
    <li>
        <h2>Week10: Interactivity.</h2>
        <p>Build and embed two interactive charts.</p>
        <div>
        </div>
    </li>
</ol>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script defer>
        document.querySelectorAll('div.chartJs').forEach(
            async function(el) {
                const ctx = el.querySelector('canvas');
                const dataFunction = ctx.getAttribute('data-data-function');
                const dataEl = el.querySelector('script[type="text/data"]');
                const dataScript = el.querySelector('script[type="text/javascript-function"]');
                let data;
                let code;
                let codeLanguage = 'javascript';
                if (dataEl) {
                    code = dataEl.innerText;
                    data = JSON.parse(dataEl.innerText);
                    codeLanguage = 'json';
                }
                else if (dataScript) {
                    code = dataScript.innerText;
                    await eval(dataScript.innerText);
                }
                if (code) {
                    exposeCode(code, codeLanguage, el);
                }

                new Chart(ctx, data);
            }
        );


        function exposeCode(code, language, parentEl) {
            const firstLineWhiteSpace = code.match(/(?<=\n)\s+(?=\S)/m);
            code = code.replaceAll(firstLineWhiteSpace[0],'');
            const codeEl = document.createElement('pre');
            codeEl.innerHTML = '<code>' + hljs.highlight(code, {language}).value + '</code>';
            parentEl.appendChild(codeEl);
        }

        document.querySelectorAll('script.expose').forEach(
            (el) => {
                exposeCode(
                    el.innerText,
                    'javascript',
                    el.closest('div')
                );
            }
        );
    </script>
    <script src="https://cdn.jsdelivr.net/npm/vega@5.22.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.6.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.21.0"></script>
    <script src="scripts.js"></script>
</main>
</body>
</html>